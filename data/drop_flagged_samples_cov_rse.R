library("sessioninfo")
library("SummarizedExperiment")

# load cov_rse data
load("degradation_rse_MDDseq_BiPSeq_BothRegions.Rdata", verbose = TRUE)

# load filtered rse_gene object
load(file.path("without_flagged", "rse_gene_bp_mdd.Rdata"), verbose = TRUE)


## Find samples kept in filtered rse_gene object
keep_samples <- colData(cov_rse)$RNum %in% colData(rse_gene)$RNum
table(keep_samples)
dim(rse_gene)

#### subset samples
dim(cov_rse)
cov_rse <- cov_rse[, keep_samples]
dim(cov_rse)

## add pd data from rse_gene
colData(cov_rse) <- colData(rse_gene)

# Save data
save(cov_rse, file = file.path("without_flagged", "degradation_rse_MDDseq_BiPSeq_BothRegions.Rdata"))

# sgejobs::job_single('drop_flagged_samples_cov_rse', create_shell = TRUE, memory = '40G', command = "Rscript drop_flagged_samples_cov_rse.R")


## Reproducibility information
print("Reproducibility information:")
Sys.time()
proc.time()
options(width = 120)
session_info()


# [1] "Reproducibility information:"
# > Sys.time()
# [1] "2020-05-05 11:58:59 EDT"
# > proc.time()
#     user   system  elapsed
#    8.034    0.776 4044.714
# > options(width = 120)
# > session_info()
# ??? Session info ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
#  setting  value
#  version  R version 3.6.1 Patched (2019-10-31 r77350)
#  os       CentOS Linux 7 (Core)
#  system   x86_64, linux-gnu
#  ui       X11
#  language (EN)
#  collate  en_US.UTF-8
#  ctype    en_US.UTF-8
#  tz       US/Eastern
#  date     2020-05-05
#
# ??? Packages ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
#  package              * version  date       lib source
#  assertthat             0.2.1    2019-03-21 [2] CRAN (R 3.6.1)
#  Biobase              * 2.46.0   2019-10-29 [2] Bioconductor
#  BiocGenerics         * 0.32.0   2019-10-29 [2] Bioconductor
#  BiocParallel         * 1.20.1   2019-12-21 [2] Bioconductor
#  bitops                 1.0-6    2013-08-17 [2] CRAN (R 3.6.1)
#  cli                    2.0.2    2020-02-28 [1] CRAN (R 3.6.1)
#  colorout             * 1.2-2    2020-04-23 [1] Github (jalvesaq/colorout@726d681)
#  crayon                 1.3.4    2017-09-16 [2] CRAN (R 3.6.1)
#  DelayedArray         * 0.12.2   2020-01-06 [2] Bioconductor
#  fansi                  0.4.1    2020-01-08 [2] CRAN (R 3.6.1)
#  GenomeInfoDb         * 1.22.0   2019-10-29 [2] Bioconductor
#  GenomeInfoDbData       1.2.2    2019-10-28 [2] Bioconductor
#  GenomicRanges        * 1.38.0   2019-10-29 [2] Bioconductor
#  glue                   1.4.0    2020-04-03 [1] CRAN (R 3.6.1)
#  IRanges              * 2.20.2   2020-01-13 [2] Bioconductor
#  lattice                0.20-38  2018-11-04 [3] CRAN (R 3.6.1)
#  Matrix                 1.2-17   2019-03-22 [3] CRAN (R 3.6.1)
#  matrixStats          * 0.55.0   2019-09-07 [2] CRAN (R 3.6.1)
#  RCurl                  1.98-1.1 2020-01-19 [2] CRAN (R 3.6.1)
#  S4Vectors            * 0.24.3   2020-01-18 [2] Bioconductor
#  sessioninfo          * 1.1.1    2018-11-05 [2] CRAN (R 3.6.1)
#  SummarizedExperiment * 1.16.1   2019-12-19 [2] Bioconductor
#  withr                  2.2.0    2020-04-20 [1] CRAN (R 3.6.1)
#  XVector                0.26.0   2019-10-29 [2] Bioconductor
#  zlibbioc               1.32.0   2019-10-29 [2] Bioconductor
#
# [1] /users/lhuuki/R/3.6.x
# [2] /jhpce/shared/jhpce/core/conda/miniconda3-4.6.14/envs/svnR-3.6.x/R/3.6.x/lib64/R/site-library
# [3] /jhpce/shared/jhpce/core/conda/miniconda3-4.6.14/envs/svnR-3.6.x/R/3.6.x/lib64/R/library
