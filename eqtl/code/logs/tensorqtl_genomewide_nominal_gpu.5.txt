Adding LIBD modules
Loading git
Loading LIBD module for git-status-size/github
Loading LIBD module for git-lfs/2.8.0
Loading LIBD module for rmate/1.5.9
Loading LIBD module for ruby/2.6.4p104
Loading conda_R/devel
**** Job starts ****
Thu Apr  7 12:45:08 EDT 2022
**** JHPCE info ****
User: lhuuki
Job id: 9847703
Job name: tensorqtl_genomewide_nominal_gpu
Hostname: compute-126.cm.cluster
Task id: 5
Loading LIBD module for tensorQTL/1.0.6
Unloading conda_R/devel
Loading conda_R/4.1.x

The following have been reloaded with a version change:
  1) conda_R/devel => conda_R/4.1.x


Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV  11) ruby/2.6.4p104
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV      12) rmate/1.5.9
  3) JHPCE_tools/1.0   8) git-status-size/github         13) conda/3-4.6.14
  4) sge/8.1.9         9) git/2.28.0                     14) conda_R/4.1.x
  5) gcc/4.4.7        10) git-lfs/2.8.0                  15) tensorqtl/1.0.6

 

Processing pair: jxn_Amygdala
****************************
** Hopkins NEWS and Notes **
****************************

News and updates for the R installation will be sent to bit-help, so consider subscribing

An automatic user library has been created (in case it did not already exist) as
    /users/lhuuki/R/4.1.x 
install.packages and R CMD INSTALL will automatically install to this directory, so there is no need for a -l or a lib argument to these functions.

Loading required package: utils
The following packages are installed in both /users/lhuuki/R/4.1.x and system-wide
    Package User_Version System_Version
1  biocthis        1.5.0          1.4.0
2     irlba        2.3.5          2.3.5
3 lifecycle        1.0.1          1.0.1
4    pillar        1.7.0          1.7.0
5        R6        2.5.1          2.5.1
User installed packages will override the system ones, irrespective of version
******* End NEWS ***********
PyTorch 1.8.2+cu111
Pandas 1.4.0
FEATURE = jxn
REGION = Amygdala
Reading Expression files: ../data/tensorQTL_input/expression_bed/jxn_Amygdala.bed.gz
Phenotype dimensions:
(305558, 540)
....................
Reading Plink files: /dcl01/lieber/ajaffe/lab/goesHyde_mdd_rnaseq/genotype_data/mdd_bpd/maf01/mdd_bpd_maf01
Mapping files:   0%|          | 0/3 [00:00<?, ?it/s]Mapping files:  33%|███▎      | 1/3 [00:07<00:15,  7.84s/it]Mapping files:  67%|██████▋   | 2/3 [00:08<00:03,  3.52s/it]Mapping files: 100%|██████████| 3/3 [00:10<00:00,  3.09s/it]Mapping files: 100%|██████████| 3/3 [00:10<00:00,  3.63s/it]
Loading Genotypes...Genotype dimensions:(11031865, 616)
Using fam to assign genoSample names
Adding 'chr' to genotype positions
Excluding phenotypes from these chromosomes:
{'chrY', 'chrM'}
Phenotypes with chr in variants: 
True     304125
False      1433
Name: chr, dtype: int64

**** STARTING tensorQTL ****
Saving output to: /dcl01/lieber/ajaffe/lab/goesHyde_mdd_rnaseq/eqtl/data/tensorQTL_out/genomewide_nominal/jxn_Amygdala
cis-QTL mapping: nominal associations for all variant-phenotype pairs
  * 540 samples
  * 304125 phenotypes
  * 59 covariates
  * 11031865 variants
  * applying in-sample 0.05 MAF filter
    ** dropping 1 constant phenotypes
  * checking phenotypes: 1000/304124  * checking phenotypes: 2000/304124  * checking phenotypes: 3000/304124  * checking phenotypes: 4000/304124  * checking phenotypes: 5000/304124  * checking phenotypes: 6000/304124  * checking phenotypes: 7000/304124  * checking phenotypes: 8000/304124  * checking phenotypes: 9000/304124  * checking phenotypes: 10000/304124  * checking phenotypes: 11000/304124  * checking phenotypes: 12000/304124  * checking phenotypes: 13000/304124  * checking phenotypes: 14000/304124  * checking phenotypes: 15000/304124  * checking phenotypes: 16000/304124  * checking phenotypes: 17000/304124  * checking phenotypes: 18000/304124  * checking phenotypes: 19000/304124  * checking phenotypes: 20000/304124  * checking phenotypes: 21000/304124  * checking phenotypes: 22000/304124  * checking phenotypes: 23000/304124  * checking phenotypes: 24000/304124  * checking phenotypes: 25000/304124  * checking phenotypes: 26000/304124  * checking phenotypes: 27000/304124  * checking phenotypes: 28000/304124  * checking phenotypes: 29000/304124  * checking phenotypes: 30000/304124  * checking phenotypes: 31000/304124  * checking phenotypes: 32000/304124  * checking phenotypes: 33000/304124  * checking phenotypes: 34000/304124  * checking phenotypes: 35000/304124  * checking phenotypes: 36000/304124  * checking phenotypes: 37000/304124  * checking phenotypes: 38000/304124  * checking phenotypes: 39000/304124  * checking phenotypes: 40000/304124  * checking phenotypes: 41000/304124  * checking phenotypes: 42000/304124  * checking phenotypes: 43000/304124  * checking phenotypes: 44000/304124  * checking phenotypes: 45000/304124  * checking phenotypes: 46000/304124  * checking phenotypes: 47000/304124  * checking phenotypes: 48000/304124  * checking phenotypes: 49000/304124  * checking phenotypes: 50000/304124  * checking phenotypes: 51000/304124  * checking phenotypes: 52000/304124  * checking phenotypes: 53000/304124  * checking phenotypes: 54000/304124  * checking phenotypes: 55000/304124  * checking phenotypes: 56000/304124  * checking phenotypes: 57000/304124  * checking phenotypes: 58000/304124  * checking phenotypes: 59000/304124  * checking phenotypes: 60000/304124  * checking phenotypes: 61000/304124  * checking phenotypes: 62000/304124  * checking phenotypes: 63000/304124  * checking phenotypes: 64000/304124  * checking phenotypes: 65000/304124  * checking phenotypes: 66000/304124  * checking phenotypes: 67000/304124  * checking phenotypes: 68000/304124  * checking phenotypes: 69000/304124  * checking phenotypes: 70000/304124  * checking phenotypes: 71000/304124  * checking phenotypes: 72000/304124  * checking phenotypes: 73000/304124  * checking phenotypes: 74000/304124  * checking phenotypes: 75000/304124  * checking phenotypes: 76000/304124  * checking phenotypes: 77000/304124  * checking phenotypes: 78000/304124  * checking phenotypes: 79000/304124  * checking phenotypes: 80000/304124  * checking phenotypes: 81000/304124  * checking phenotypes: 82000/304124  * checking phenotypes: 83000/304124  * checking phenotypes: 84000/304124  * checking phenotypes: 85000/304124  * checking phenotypes: 86000/304124  * checking phenotypes: 87000/304124  * checking phenotypes: 88000/304124  * checking phenotypes: 89000/304124  * checking phenotypes: 90000/304124  * checking phenotypes: 91000/304124  * checking phenotypes: 92000/304124  * checking phenotypes: 93000/304124  * checking phenotypes: 94000/304124  * checking phenotypes: 95000/304124  * checking phenotypes: 96000/304124  * checking phenotypes: 97000/304124  * checking phenotypes: 98000/304124  * checking phenotypes: 99000/304124  * checking phenotypes: 100000/304124  * checking phenotypes: 101000/304124  * checking phenotypes: 102000/304124  * checking phenotypes: 103000/304124  * checking phenotypes: 104000/304124  * checking phenotypes: 105000/304124  * checking phenotypes: 106000/304124  * checking phenotypes: 107000/304124  * checking phenotypes: 108000/304124  * checking phenotypes: 109000/304124  * checking phenotypes: 110000/304124  * checking phenotypes: 111000/304124  * checking phenotypes: 112000/304124  * checking phenotypes: 113000/304124  * checking phenotypes: 114000/304124  * checking phenotypes: 115000/304124  * checking phenotypes: 116000/304124  * checking phenotypes: 117000/304124  * checking phenotypes: 118000/304124  * checking phenotypes: 119000/304124  * checking phenotypes: 120000/304124  * checking phenotypes: 121000/304124  * checking phenotypes: 122000/304124  * checking phenotypes: 123000/304124  * checking phenotypes: 124000/304124  * checking phenotypes: 125000/304124  * checking phenotypes: 126000/304124  * checking phenotypes: 127000/304124  * checking phenotypes: 128000/304124  * checking phenotypes: 129000/304124  * checking phenotypes: 130000/304124  * checking phenotypes: 131000/304124  * checking phenotypes: 132000/304124  * checking phenotypes: 133000/304124  * checking phenotypes: 134000/304124  * checking phenotypes: 135000/304124  * checking phenotypes: 136000/304124  * checking phenotypes: 137000/304124  * checking phenotypes: 138000/304124  * checking phenotypes: 139000/304124  * checking phenotypes: 140000/304124  * checking phenotypes: 141000/304124  * checking phenotypes: 142000/304124  * checking phenotypes: 143000/304124  * checking phenotypes: 144000/304124  * checking phenotypes: 145000/304124  * checking phenotypes: 146000/304124  * checking phenotypes: 147000/304124  * checking phenotypes: 148000/304124  * checking phenotypes: 149000/304124  * checking phenotypes: 150000/304124  * checking phenotypes: 151000/304124  * checking phenotypes: 152000/304124  * checking phenotypes: 153000/304124  * checking phenotypes: 154000/304124  * checking phenotypes: 155000/304124  * checking phenotypes: 156000/304124  * checking phenotypes: 157000/304124  * checking phenotypes: 158000/304124  * checking phenotypes: 159000/304124  * checking phenotypes: 160000/304124  * checking phenotypes: 161000/304124  * checking phenotypes: 162000/304124  * checking phenotypes: 163000/304124  * checking phenotypes: 164000/304124  * checking phenotypes: 165000/304124  * checking phenotypes: 166000/304124  * checking phenotypes: 167000/304124  * checking phenotypes: 168000/304124  * checking phenotypes: 169000/304124  * checking phenotypes: 170000/304124  * checking phenotypes: 171000/304124  * checking phenotypes: 172000/304124  * checking phenotypes: 173000/304124  * checking phenotypes: 174000/304124  * checking phenotypes: 175000/304124  * checking phenotypes: 176000/304124  * checking phenotypes: 177000/304124  * checking phenotypes: 178000/304124  * checking phenotypes: 179000/304124  * checking phenotypes: 180000/304124  * checking phenotypes: 181000/304124  * checking phenotypes: 182000/304124  * checking phenotypes: 183000/304124  * checking phenotypes: 184000/304124  * checking phenotypes: 185000/304124  * checking phenotypes: 186000/304124  * checking phenotypes: 187000/304124  * checking phenotypes: 188000/304124  * checking phenotypes: 189000/304124  * checking phenotypes: 190000/304124  * checking phenotypes: 191000/304124  * checking phenotypes: 192000/304124  * checking phenotypes: 193000/304124  * checking phenotypes: 194000/304124  * checking phenotypes: 195000/304124  * checking phenotypes: 196000/304124  * checking phenotypes: 197000/304124  * checking phenotypes: 198000/304124  * checking phenotypes: 199000/304124  * checking phenotypes: 200000/304124  * checking phenotypes: 201000/304124  * checking phenotypes: 202000/304124  * checking phenotypes: 203000/304124  * checking phenotypes: 204000/304124  * checking phenotypes: 205000/304124  * checking phenotypes: 206000/304124  * checking phenotypes: 207000/304124  * checking phenotypes: 208000/304124  * checking phenotypes: 209000/304124  * checking phenotypes: 210000/304124  * checking phenotypes: 211000/304124  * checking phenotypes: 212000/304124  * checking phenotypes: 213000/304124  * checking phenotypes: 214000/304124  * checking phenotypes: 215000/304124  * checking phenotypes: 216000/304124  * checking phenotypes: 217000/304124  * checking phenotypes: 218000/304124  * checking phenotypes: 219000/304124  * checking phenotypes: 220000/304124  * checking phenotypes: 221000/304124  * checking phenotypes: 222000/304124  * checking phenotypes: 223000/304124  * checking phenotypes: 224000/304124  * checking phenotypes: 225000/304124  * checking phenotypes: 226000/304124  * checking phenotypes: 227000/304124  * checking phenotypes: 228000/304124  * checking phenotypes: 229000/304124  * checking phenotypes: 230000/304124  * checking phenotypes: 231000/304124  * checking phenotypes: 232000/304124  * checking phenotypes: 233000/304124  * checking phenotypes: 234000/304124  * checking phenotypes: 235000/304124  * checking phenotypes: 236000/304124  * checking phenotypes: 237000/304124  * checking phenotypes: 238000/304124  * checking phenotypes: 239000/304124  * checking phenotypes: 240000/304124  * checking phenotypes: 241000/304124  * checking phenotypes: 242000/304124  * checking phenotypes: 243000/304124  * checking phenotypes: 244000/304124  * checking phenotypes: 245000/304124  * checking phenotypes: 246000/304124  * checking phenotypes: 247000/304124  * checking phenotypes: 248000/304124  * checking phenotypes: 249000/304124  * checking phenotypes: 250000/304124  * checking phenotypes: 251000/304124  * checking phenotypes: 252000/304124  * checking phenotypes: 253000/304124  * checking phenotypes: 254000/304124  * checking phenotypes: 255000/304124  * checking phenotypes: 256000/304124  * checking phenotypes: 257000/304124  * checking phenotypes: 258000/304124  * checking phenotypes: 259000/304124  * checking phenotypes: 260000/304124  * checking phenotypes: 261000/304124  * checking phenotypes: 262000/304124  * checking phenotypes: 263000/304124  * checking phenotypes: 264000/304124  * checking phenotypes: 265000/304124  * checking phenotypes: 266000/304124  * checking phenotypes: 267000/304124  * checking phenotypes: 268000/304124  * checking phenotypes: 269000/304124  * checking phenotypes: 270000/304124  * checking phenotypes: 271000/304124  * checking phenotypes: 272000/304124  * checking phenotypes: 273000/304124  * checking phenotypes: 274000/304124  * checking phenotypes: 275000/304124  * checking phenotypes: 276000/304124  * checking phenotypes: 277000/304124  * checking phenotypes: 278000/304124  * checking phenotypes: 279000/304124  * checking phenotypes: 280000/304124  * checking phenotypes: 281000/304124  * checking phenotypes: 282000/304124  * checking phenotypes: 283000/304124  * checking phenotypes: 284000/304124  * checking phenotypes: 285000/304124  * checking phenotypes: 286000/304124  * checking phenotypes: 287000/304124  * checking phenotypes: 288000/304124  * checking phenotypes: 289000/304124  * checking phenotypes: 290000/304124  * checking phenotypes: 291000/304124  * checking phenotypes: 292000/304124  * checking phenotypes: 293000/304124  * checking phenotypes: 294000/304124  * checking phenotypes: 295000/304124  * checking phenotypes: 296000/304124  * checking phenotypes: 297000/304124  * checking phenotypes: 298000/304124  * checking phenotypes: 299000/304124  * checking phenotypes: 300000/304124  * checking phenotypes: 301000/304124  * checking phenotypes: 302000/304124  * checking phenotypes: 303000/304124  * checking phenotypes: 304000/304124    ** dropping 2254 phenotypes without variants in cis-window
  * Computing associations
    Mapping chromosome chr1
    time elapsed: 2.83 min
Traceback (most recent call last):
  File "/dcl01/lieber/ajaffe/lab/goesHyde_mdd_rnaseq/eqtl/code/tensorqtl_genomewide_nominal.py", line 24, in <module>
    cis.map_nominal(genotype_df, variant_df, phenotype_df, phenotype_pos_df, prefix = tag, covariates_df= covariates_df,
  File "/jhpce/shared/jhpce/libd/tensorqtl/1.0.6/tensorqtl_venv/lib/python3.9/site-packages/tensorqtl/cis.py", line 422, in map_nominal
    chr_res_df = pd.DataFrame(chr_res)
  File "/jhpce/shared/jhpce/libd/tensorqtl/1.0.6/tensorqtl_venv/lib/python3.9/site-packages/pandas/core/frame.py", line 637, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/jhpce/shared/jhpce/libd/tensorqtl/1.0.6/tensorqtl_venv/lib/python3.9/site-packages/pandas/core/internals/construction.py", line 502, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/jhpce/shared/jhpce/libd/tensorqtl/1.0.6/tensorqtl_venv/lib/python3.9/site-packages/pandas/core/internals/construction.py", line 156, in arrays_to_mgr
    return create_block_manager_from_column_arrays(
  File "/jhpce/shared/jhpce/libd/tensorqtl/1.0.6/tensorqtl_venv/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 1959, in create_block_manager_from_column_arrays
    mgr._consolidate_inplace()
  File "/jhpce/shared/jhpce/libd/tensorqtl/1.0.6/tensorqtl_venv/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 1685, in _consolidate_inplace
    self.blocks = tuple(_consolidate(self.blocks))
  File "/jhpce/shared/jhpce/libd/tensorqtl/1.0.6/tensorqtl_venv/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 2084, in _consolidate
    merged_blocks = _merge_blocks(
  File "/jhpce/shared/jhpce/libd/tensorqtl/1.0.6/tensorqtl_venv/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 2118, in _merge_blocks
    new_values = new_values[argsort]
numpy.core._exceptions.MemoryError: Unable to allocate 635. MiB for an array with shape (3, 55496927) and data type float32
**** Job ends ****
Thu Apr  7 12:52:35 EDT 2022
