Adding LIBD modules
Loading git
Loading LIBD module for git-status-size/github
Loading LIBD module for git-lfs/2.8.0
Loading LIBD module for rmate/1.5.9
Loading LIBD module for ruby/2.6.4p104
Loading conda_R/4.3
**** Job starts ****
Wed Aug 30 12:49:26 EDT 2023
**** JHPCE info ****
User: lhuuki
Job id: 3698154
Job name: tensorqtl_risk_interaction
Hostname: compute-126.cm.cluster
Task id: undefined
Loading LIBD module for tensorQTL/1.0.8
Unloading conda_R/4.3
Loading conda_R/4.3

Currently Loaded Modules:
  1) matlab/R2019a     6) COMMUNITY_CENTOS7_DEFAULT_ENV  11) ruby/2.6.4p104
  2) stata/17          7) JHPCE_CENTOS7_DEFAULT_ENV      12) rmate/1.5.9
  3) JHPCE_tools/1.0   8) git-status-size/github         13) conda/3-4.11.0
  4) sge/8.1.9         9) git/2.28.0                     14) conda_R/4.3
  5) gcc/4.4.7        10) git-lfs/2.8.0                  15) tensorqtl/1.0.8

 

****************************
** Hopkins NEWS and Notes **
****************************

News and updates for the R installation will be sent to bit-help, so consider subscribing

An automatic user library has been created (in case it did not already exist) as
    /users/lhuuki/R/4.3 
install.packages and R CMD INSTALL will automatically install to this directory, so there is no need for a -l or a lib argument to these functions.

Loading required package: utils
The following packages are installed in both /users/lhuuki/R/4.3 and system-wide
   Package User_Version System_Version
1 biocthis       1.10.3         1.10.3
User installed packages will override the system ones, irrespective of version
******* End NEWS ***********
PyTorch 1.11.0+cu113
Pandas 2.0.2
Reading Expression files: ../data/tensorQTL_input/expression_bed/gene_Amygdala.bed.gz
Phenotype dimensions:
(25212, 540)
....................
Reading Plink files: ../data/risk_snps/LIBD_maf01_gwas_BPD
Mapping files:   0%|          | 0/3 [00:00<?, ?it/s]Mapping files: 100%|██████████| 3/3 [00:00<00:00, 375.24it/s]
Loading Genotypes...Genotype dimensions:(63, 616)
Using fam to assign genoSample names
Adding 'chr' to genotype positions
Excluding phenotypes from these chromosomes:
{'chr19', 'chrM', 'chrX', 'chr21', 'chr18', 'chrY'}
Phenotypes with chr in variants: 
chr
True     22056
False     3156
Name: count, dtype: int64
gene_Amygdala_Astro
cis-QTL mapping: nominal associations for all variant-phenotype pairs
  * 540 samples
  * 22056 phenotypes
  * 44 covariates
  * 63 variants
  * including 1 interaction term(s)
    * using 0.05 MAF threshold
  * cis-window: ±500,000
Traceback (most recent call last):
  File "/dcs04/lieber/lcolladotor/hydeGoes_LIBD3010/goesHyde_mdd_rnaseq/eqtl/code/10_tensorqtl_risk_interaction_BPD.py", line 22, in <module>
    nominal_out = cis.map_nominal(genotype_df, variant_df, phenotype_df, phenotype_pos_df,
  File "/jhpce/shared/jhpce/libd/tensorqtl/1.0.8/tensorqtl/tensorqtl/cis.py", line 180, in map_nominal
    genotype_ix = np.array([genotype_df.columns.tolist().index(i) for i in phenotype_df.columns])
  File "/jhpce/shared/jhpce/libd/tensorqtl/1.0.8/tensorqtl/tensorqtl/cis.py", line 180, in <listcomp>
    genotype_ix = np.array([genotype_df.columns.tolist().index(i) for i in phenotype_df.columns])
ValueError: '4572348328_R01C01' is not in list
**** Job ends ****
Wed Aug 30 12:49:40 EDT 2023
